# Описание 
Данный репозиторий содержит модели классификации для CV ruCode


# Установка

Сначала необходимо установить `torch` gpu нужной вам версии cuda. Если не планируете ипользовать gpu смело пропускайте этот шаг
```commandline
pip3 install torch torchvision torchaudio --index-url https://download.pytorch.org/whl/cu118
```

Далее для установки зависимостей выполните команду:
```commandline
pip install -r requirements.txt
```
# Запуск
Конфигурирование производится с помощью конфигов в каталоге `configs`.

*Лучше всего запускать скрипты из корневой дирректории.*

Назначения конфигурационных файлов:
- `predict_params.yaml` --- конфигурационный файл для запуска пайплайна предсказания;
- `train_config.yaml` --- конфигурационный файл для запуска пайплайна обучения;
- `splitting_config.yaml` --- конфигурационный файл с параметрами для разделения датасета на test и valid.

## Подготовка данных
Перед обучением необходимо преобразовать данные в нужный формат, для этого необходимо воспользоваться скриптом `src/reformer_dataset.py`
Далее необходимо разделить набора данных на обучеющую и валидационную выборки. 
Для этого необходимо воспользоваться скриптом `scr/split_dataset`, 
предварительно настроив параметра в конфигурационном файле

Параметры:
- path_to_dataset --- Путь до датасета 
- test_size --- Доля тестового набора 
- name_file --- CSV файл, содержащий имена файлов

Файлы, содержащие обучающий и валидационной наборы будут созданы в дирректории датасета 
с именами `train_.csv` и `valid_.csv` соответственно.


## Обучение
Для запуска `src/train` необходимо настроить следующие параметры:

 - path_to_classes --- JSON-файл, содержащий кодирование классов в числовые значения меток (По умолчанию находится в `data/encode_classes.json`)
 - path_to_weights --- Путь до модели, веса которой необходимо загрузить (Для дообучения)
 - path_to_dataset --- Путь до датасета

Параметр `path_save_checkpoint` изменять не нужно. Модели сохряняются в каталог с логами, а именно: `./runs/<cur datetime>/models`.

*Остальные параметры могут изменяться по желанию*

## Предсказание
Перед запуском `src/predict` необходимо настроить следующие параметры:
- path_to_classes --- JSON-файл, содержащий кодирование классов в числовые значения меток (По умолчанию находится в `data/encode_classes.json`)
- path_to_weights --- Путь до модели, веса которой необходимо загрузить
- path_to_dataset --- Путь до датасета
- name_model --- Наименование архитектуры используемой при обучении
- path_to_save_result --- Путь сохранения результата классификации в виде csv файла
- visualize_result --- Параметр для копирования изображений в папку соответствующую результату классификации (Исключительно для визуальной оценки результатов классификации). Если True то сохраняем результат, иначе False
- path_to_save_images ---  Каталог для сохранения изображений из предыдущего параметра

*Остальные параметры могут изменяться по желанию*


## Просмотр процесса обучения
Процесс обучения логируется с помощью `tensorboard`. Для его просмотра необходимо выполнить команду:
```commandline
tensorboard --logdir=<folder "runs">
```
<folder "runs"> --- Каталог с логами. По находится в папке запуска `train`.



